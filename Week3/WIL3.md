- 순수 jdbc

jdbc memberRepository 
db에 연결한 구현체 만들기
db에 붙으려면 data source가 필요. 
javax.sql 필요. -> 나중에 spring에게 주입받음. 
connection 으로 database 커넥션 가져옴. 

쓴 자원들 릴리즈 잘해줘야함. 

파인드 올 멤버를 쭉 담고 반환. 

@configuration한 것도 스프링 빈으로 관리 됨. 
스프링을 왜 쓰냐 ? 객체지향 설계가 왜 좋냐 하면
다형성을 활용한다. 인터페이스를 두고 구현체를 바꿔 낄 수 있다. 
스프링 컨테이너 활용해 가능하게 한다. -> DI가 이걸 편하게 해준다.
애플리케이션 조립코드만 손대면 나머지 실제 애플리케이션 코드는 손댈 게 없다. 

구현체인 jdbcmr과 mmr이 구현체로 interface에 의존 중. 근데 jdbc등록하면 구현체가 이제 jdbc가 돼서 얘로 돌아간다.
OCP(개방 폐쇄 원칙): open closed principle 기능 추가는 가능하다 근데 변경에는 닫혀있다 객체지향에서의 다형성이라는 개념을 활용하면 기능을 완전히 변경해도 실제 애플리케이션 동작에 필요한 코드들은 변경하지 않아도 된다. 


- 스프링 통합 테스트
이제 테스트는 스프링이랑 엮어서 한다.
MST는 자바 메모리에서 끝나지만 디비에 연결해서 한 거는 다르다. 

@SpringBootTest
스프링 컨테이너와 테스트를 함께 실행. 

@Transactional 
테스트케이스에 붙었을 때만 롤백으로 동작. 
이 애노테이션이 있으면, 테스트 시작 전에 트랜잭션을 시작하고, 테스트 완료 후에 항상 롤백한다. 이렇게 하면 DB에 데이터가 남지 않으므로 다음 테스트에 영향을 주지 않는다. 
데이터베이스는 기본적으로 트랜잭션이라는 개념이 있다.
커밋을 해줘야 들어간다(자동으로 커밋하냐 안하냐 차이) 
커밋하기 전까지는 디비에 반영되지 않는다. 
테스트끝나고 롤백해버리면 디비에 데이터가 반영되지 않는다. 다음에 테스트할 때 롤백되기 때문에 바로 다른 테스트 진행 가능. 


테스트할 때 위에거 작성. 

스프링 컨테이너에게 @Autowired 멤버서비스를 넣어달라고 할거다. 필요한 걸 그냥 인젝션 하면 끝나기 때문에 필드기반 autowired 해도 상관 없다. 

단위단위대로 쪼개서 테스트할 수 있게 훈련하는 것이 좋다.


- JDBC Template

생성자가 하나일때는 autowired 생략 가능. 
객체 생성에 관한 건 memberRowMapper()로 한다.
 사용법은 jdbc template document로 공부 가능. 
 기본적인 틀은 쿼리날리면 로우매퍼로 날려서 매핑하면 멤버 리스트로 반환한다. 
 테스트 케이스에서 컨트롤 알 누르면 마지막으로 실행한 테스트케이스 실행.
 실제 개발에서 시간의 60~70프로는 테스트코드를 짜는데 사용한다. 
 프로덕션의 코드가 커지면 테스트 코드가 더더욱 중요해진다. 


-JPA
sql쿼리도 JPA가 자동으로 처리해준다. 단순히 sql만드는 것 넘어서 sql보다는 객체중심의 설계로 패러다임 전환 가능. -> 개발 생산성 업
jpa는 객체를 보고 자동으로 테이블을 만듬. 
spring.jpa.hibernate.ddl-auto=create 라고 하면 자동으로 테이블 생성. 

스프링은 해당 클래스의 메서드를 실행할 때 트랜잭션 시작, 메서드가 정상 종료되면 트랜잭션 커밋. -> 런타임 예외 발생하면 롤백
jpa를 통한 모든 데이터 변경은 트랜잭션 안에서 실행. 

- 스프링 데이터 JPA
스프링 데이터 JPA 사용하면, 리포지토리에 구현 클래스 없이 인터페이스 만으로 개발 완료 가능. 
기본 crud 기능도 스프링 데이터 jpa가 모두 제공. 
스프링 부트 + jpa + 스프링 데이터 JPA == 환상 // 실무에서 관계형 데이터베이스를 사용한다면, 스프링 데이터 jpa는 필수. 
학습 순서 : jpa -> 스프링 데이터 jpa

실무에서는 jpa와 스프링 데이터 jpa를 기본 사용하고, 동적 쿼리는 Querydsl이라는 라이브러리 사용. -> 
이 조합으로도 어렵다면, jpa가 제공하는 네이티브 쿼리를 사용하거나, JdbcTemplate를 사용. 


- AOP
메소드의 호출 시간 측정 / 공통 관심 사항과 핵심 관심 사항 구분 / 회원 가입 시간, 회원 조회 시간 측정 :: AOP
시간 측정 로직 : 공통 관심 사항. 

